<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>夏娜酱的菠萝包</title>
  <meta name="author" content="cqyxy">
  
  <meta name="description" content="F.E.D">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="夏娜酱的菠萝包"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="夏娜酱的菠萝包" type="application/atom+xml">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css">
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
<link rel="stylesheet" href="/css/style.css">
  <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-368771XX-X']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>

<body>
  <header id="header" class='normal_mode'>
    <nav id="main-nav">
  <ul class='container'>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
  </header>
  <div id="content" class="container">
    <div id="cover">
	<div id="profile" alt="http://ww1.sinaimg.cn/large/6cea169fjw1edgyzma1xcj21kw16ohba.jpg">
		<a href="/">
			<div class="logo">
				<img src="/favi.jpg" alt="Profile Picture">
			</div>
			<div id="title">夏娜酱的菠萝包</div>
		</a>

		
			<div id="subtitle">比萌更萌叫荡漾</div>
		
		 <ul class="my-socials">
  
  <li>
  	<a href="https://github.com/twodogwang" class="github" target="_blank">
  		<i class="fa fa-github"></i>
  	</a>
  </li>
  
  <li>
  	<a href="https://weibo.com/2884432367/profile?topnav=1&wvr=6" class="weibo" target="_blank">
  		<i class="fa fa-weibo"></i>
  	</a>
  </li>
  
 
</ul>
	</div>
</div>


  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-31T15:52:21.000Z"><a href="/2018/01/31/post/">Wed, Jan 31 2018, 11:52:21 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/31/post/">js的执行和event loop</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/js-nodejs-eventloop-microtask-macrotask/">js,nodejs,eventloop,microtask,macrotask</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <h2 id="今天无聊，想到如果多个请求同时发出，node会如何工作。于是测试了一下"><a href="#今天无聊，想到如果多个请求同时发出，node会如何工作。于是测试了一下" class="headerlink" title="今天无聊，想到如果多个请求同时发出，node会如何工作。于是测试了一下"></a>今天无聊，想到如果多个请求同时发出，node会如何工作。于是测试了一下</h2><ol>
<li>因为考虑到线程进程的概念，于是上网查询了一下。<a href="https://www.cnblogs.com/dudeyouth/p/6698274.html" target="_blank" rel="noopener">node是单线程的。</a>IO操作是阻塞的，node的非阻塞IO其实是异步IO，通过事件驱动，交由别人来处理IO，等处理完了，再把IO结果加入队列中。所以异步IO的优势在于，可以处理高密集型IO操作，数据库读取，http请求等。所以node适合做web服务端的程序。</li>
<li>考虑到多个请求同时进行，在一个node程序中进行实践模拟。在同步的地方进行了一个大数值的循环，此时通过postman进行两次请求。果然第一次的请求阻塞中，没有返回，第二个请求甚至连阻塞之前的console都没打印。</li>
<li>然后，将大数值的循环放入await中。由于await类似于同步，直接阻塞，所以和第一次一样，都阻塞了。</li>
<li>第三次，将await去掉，只保留promise。将大循环放入promise的then中。此时第一次请求进行，一秒钟不到得到了返回，并且在返回后，控制台输出了循环结束后面的一个console。但是并不是如此简单，如果第一次在then中，then指定的回调没有处理完，第二次的请求也没有了反应，和前两次一样，可见还是阻塞住了。</li>
<li>随后又去看了promise的实现原理，个人感觉和一般的异步不一样，事实证明果然如此，从event loop又扯到了task queue，又扯到了组成部分<a href="http://blog.csdn.net/sjn0503/article/details/76087631" target="_blank" rel="noopener">macrotask和microtask。</a>未完待续…</li>
</ol>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/31/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/31/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/31/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-29T13:31:45.000Z"><a href="/2018/01/29/post/">Mon, Jan 29 2018, 9:31:45 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/29/post/">update相关钩子</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/vue-router/">vue-router</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <h2 id="第一次用关于update的钩子"><a href="#第一次用关于update的钩子" class="headerlink" title="第一次用关于update的钩子"></a>第一次用关于update的钩子</h2><hr>
<p>updated</p>
<blockquote>
<p>由于数据更改导致的虚拟 DOM 重新渲染和打补丁，在这之后会调用该钩子。<br>当这个钩子被调用时，组件 DOM 已经更新，所以你现在可以执行依赖于 DOM 的操作。然而在大多数情况下，你应该避免在此期间更改状态。如果要相应状态改变，通常最好使用计算属性或 watcher 取而代之。<br>注意 updated 不会承诺所有的子组件也都一起被重绘。如果你希望等到整个视图都重绘完毕，可以用 vm.$nextTick 替换掉 updated：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">updated: function () &#123;</span><br><span class="line">  this.$nextTick(function () &#123;</span><br><span class="line">    // Code that will run only after the</span><br><span class="line">    // entire view has been re-rendered</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>beforeUpdate</p>
<blockquote>
<p>据更新时调用，发生在虚拟 DOM 重新渲染和打补丁之前。<br>你可以在这个钩子中进一步地更改状态，这不会触发附加的重渲染过程。</p>
</blockquote>
<p>今天在调用beforeUpdate钩子函数时，进行了请求，得到response后进行了数据的赋值，结果进入一个循环，不停地在update的过程中，不停地触发这个钩子函数。后来查了查vue-router的api，其中的导航守卫应该可以使用。由于参数或查询的改变并不会触发进入/离开的导航守卫，所以不考虑进入（router.beforeEach）和离开（router.afterEach）两个全局钩子，可以使用定义在组件内的守卫beforeRouteUpdate，该方法接受三个参数，to,from,next。to为将要进入的目标路由对象（也就是组件内的$route，内有path，params等等属性），from为将要离开的路由，而next为一个方法，一定要调用该方法resolve掉这个钩子函数。具体next的参数可以参照<a href="https://router.vuejs.org/zh-cn/advanced/navigation-guards.html" target="_blank" rel="noopener">官方文档</a>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteUpdate (to, from, next) &#123;</span><br><span class="line">    // 在当前路由改变，但是该组件被复用时调用</span><br><span class="line">    // 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span><br><span class="line">    // 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span><br><span class="line">    // 可以访问组件实例 `this`</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/29/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/29/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/29/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-26T15:32:53.000Z"><a href="/2018/01/26/post/">Fri, Jan 26 2018, 11:32:53 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/26/post/">Vue的v-if问题和组件中props和data的问题</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/Vue、生命周期、钩子函数、子组件父组件/">Vue、生命周期、钩子函数、子组件父组件</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <h1 id="今天在修改项目的时候有个问题"><a href="#今天在修改项目的时候有个问题" class="headerlink" title="今天在修改项目的时候有个问题"></a>今天在修改项目的时候有个问题</h1><ol>
<li>之前在做功能的时候，通过ref取到子组件，然后通过<code>this.$refs.zizujian[0].method()</code>可以调用子组件上的方法，然后进行操作。但是今天发现之前以为修改子组件的<code>taglist</code>成功了，其实没有。子组件的<code>taglist=[].concat(this.value)</code>，这个<code>this.value</code>是通过<code>prop</code>选项传进来的，也就是说，其实个人认为是props先传入然后再形成data选项。而且，如果在data中定义的量根据<code>props</code>中的值形成的话，是没有实时更新的效果的，也就是说，除了认为修改data里的值，根据props传入的值形成的这个值是不会改变的，即使传入的值发生了变化。如果需要实时更新的话，可以通过computed选项来构建这个量，不过这样再手动修改这个值的话就会很麻烦。watch应该也可以。</li>
<li>那为什么在之前调用子组件修改taglist失败的情况下仍然可以达到效果呢？后来研究发现是v-if的问题。v-if和v-show的最大的区别就是，v-show其实是渲染在dom里面的，只是修改了他的display属性，而v-if如果为false的话，dom中不会有这个dom结构。我在展示和隐藏子组件的时候使用了v-if，也就是说每次隐藏和显示其实都是在修改dom结构，重新生成这个实例，生命周期都会走一边，钩子函数也会重新调用（通过setInterval定时器验证过）。那么每次在重新生成实例的时候，里面的taglist都会重新根据传入的value生成，自然也就会恢复到一开始的状态，达到取消的效果。</li>
</ol>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/26/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/26/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/26/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-24T13:09:50.000Z"><a href="/2018/01/24/post/">Wed, Jan 24 2018, 9:09:50 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/24/post/">Vue中父组件调用子组件的方法</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/Vue-父子组件/">Vue,父子组件</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <ol>
<li>这几天在网上的博客搜索父组件调用子组件的方法，基本上就是用ref。即在父组件文件中在子组件上定义ref属性，即可通过<code>this.$refs.xxx</code>取到这个节点。然后可以直接调用方法了。</li>
<li>另外，如果不怕麻烦的话，可以用eventbus。eventbus类似于一个中间人的角色，在一个js文件中，new一个Vue的实例，引入你需要进行信息方法传递的文件中，在引入的实例上触发和接收时间，即可完成方法的调用。不止在父子组件中，更常用的地方则是兄弟组件之间。</li>
</ol>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/24/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/24/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/24/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-23T12:08:58.000Z"><a href="/2018/01/23/post/">Tue, Jan 23 2018, 8:08:58 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/23/post/">Vue-cli的一点小坑</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/Vue-cli-url-webpack/">Vue-cli,url,webpack</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <p>使用Vue-cli脚手架可以方便的生成单页面的Vue项目。<code>vue init webpack 项目名</code> 即可生成一个基于脚手架的项目框架。<br> 项目结构大致如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">|-- build                            // 项目构建(webpack)相关代码</span><br><span class="line">|   |-- build.js                     // 生产环境构建代码</span><br><span class="line">|   |-- check-version.js             // 检查node、npm等版本</span><br><span class="line">|   |-- dev-client.js                // 热重载相关</span><br><span class="line">|   |-- dev-server.js                // 构建本地服务器</span><br><span class="line">|   |-- utils.js                     // 构建工具相关</span><br><span class="line">|   |-- webpack.base.conf.js         // webpack基础配置</span><br><span class="line">|   |-- webpack.dev.conf.js          // webpack开发环境配置</span><br><span class="line">|   |-- webpack.prod.conf.js         // webpack生产环境配置</span><br><span class="line">|-- config                           // 项目开发环境配置</span><br><span class="line">|   |-- dev.env.js                   // 开发环境变量</span><br><span class="line">|   |-- index.js                     // 项目一些配置变量</span><br><span class="line">|   |-- prod.env.js                  // 生产环境变量</span><br><span class="line">|   |-- test.env.js                  // 测试环境变量</span><br><span class="line">|-- src                              // 源码目录</span><br><span class="line">|   |--assets                        // 静态文件，比如一些图片，json数据等</span><br><span class="line">|   |-- components                   // vue公共组件</span><br><span class="line">|   |-- store                        // vuex的状态管理</span><br><span class="line">|   |-- App.vue                      // 页面入口文件</span><br><span class="line">|   |-- main.js                      // 程序入口文件，加载各种公共组件</span><br><span class="line">|-- static                           </span><br><span class="line">|   |-- data                         // 群聊分析得到的数据用于数据可视化</span><br><span class="line">|-- .babelrc                         // ES6语法编译配置</span><br><span class="line">|-- .editorconfig                    // 定义代码格式</span><br><span class="line">|-- .gitignore                       // git上传需要忽略的文件格式</span><br><span class="line">|-- README.md                        // 项目说明</span><br><span class="line">|-- favicon.ico </span><br><span class="line">|-- index.html                       // 入口页面</span><br><span class="line">|-- package.json                     // 项目基本信息</span><br></pre></td></tr></table></figure>
<p>在项目组，会遇到一些<code>npm run build</code>的问题，通常发生在打包后请求js文件，css文件，图片资源等等路径的问题。</p>
<ol>
<li>请求js、css文件404，由于打包时候指定的路径不对，在config/index.js文件中，可以修改assetsPublicPath的值为 ‘./‘，即相对路径，在打包完的结构中<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">|-- dist                            // 打包完成后的文件夹</span><br><span class="line">|   |-- index.html                  // 首页默认index.html</span><br><span class="line">|   |-- static                      // js、css、img文件</span><br><span class="line">|--       |-- css</span><br><span class="line">|--       |-- js</span><br><span class="line">|--       |-- img</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>index.html中的link和script脚本即可正常获取到同级的static文件夹下的文件。（配置中默认是 ‘/‘，即根目录，巨鸡儿坑）<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">build: &#123;</span><br><span class="line">    <span class="comment">// Template for index.html</span></span><br><span class="line">    index: path.resolve(__dirname, <span class="string">'../dist/index.html'</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Paths</span></span><br><span class="line">    assetsRoot: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">    assetsSubDirectory: <span class="string">'static'</span>,</span><br><span class="line">    assetsPublicPath: <span class="string">'./'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Source Maps</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    productionSourceMap: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// https://webpack.js.org/configuration/devtool/#production</span></span><br><span class="line">    devtool: <span class="string">'#source-map'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Gzip off by default as many popular static hosts such as</span></span><br><span class="line">    <span class="comment">// Surge or Netlify already gzip all static assets for you.</span></span><br><span class="line">    <span class="comment">// Before setting to `true`, make sure to:</span></span><br><span class="line">    <span class="comment">// npm install --save-dev compression-webpack-plugin</span></span><br><span class="line">    productionGzip: <span class="literal">false</span>,</span><br><span class="line">    productionGzipExtensions: [<span class="string">'js'</span>, <span class="string">'css'</span>],</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Run the build command with an extra argument to</span></span><br><span class="line">    <span class="comment">// View the bundle analyzer report after build finishes:</span></span><br><span class="line">    <span class="comment">// `npm run build --report`</span></span><br><span class="line">    <span class="comment">// Set to `true` or `false` to always turn it on or off</span></span><br><span class="line">    bundleAnalyzerReport: process.env.npm_config_report</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>解决完这个之后，只是解决了js、css文件引入的问题。我在css中一个class里添加了一个background属性，值为一个url。打包完之后，在获取时，真实的请求路径为</li>
</ol>
<p><img src="http://47.94.106.10/URL.png" alt="image"></p>
<p>，只有后半部分的/static/img/cat.caa02bc.jpg才是我们需要的。此时需要在build/utils.js里面修改<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Extract CSS when that option is specified</span></span><br><span class="line">    <span class="comment">// (which is the case during production build)</span></span><br><span class="line">    <span class="keyword">if</span> (options.extract) &#123;</span><br><span class="line">      <span class="keyword">return</span> ExtractTextPlugin.extract(&#123;</span><br><span class="line">        use: loaders,</span><br><span class="line">        publicPath:<span class="string">'../../'</span>,</span><br><span class="line">        fallback: <span class="string">'vue-style-loader'</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> [<span class="string">'vue-style-loader'</span>].concat(loaders)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>指定了publicpath之后，就可以顺利取到我们写好的相对路径URL的图片。<br>3.在写底部footer组件的时候，其中的图片我是用一个循环v-for来写（虽然根本不需要）。循环的结构是这样的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;blog-footer&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;icons&quot;&gt;</span><br><span class="line">        &lt;template v-for=&quot;(item,index) in icons&quot;&gt;</span><br><span class="line">            &lt;a target=&quot;_blank&quot; :key=&quot;index&quot; :href=&quot;item.url&quot;&gt;&lt;img  :src=&quot;item.picUrl&quot; :title=&quot;item.alt&quot; :alt=&quot;item.alt&quot;&gt;&lt;/a&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;intro&quot;&gt;这里是一句撞壁的话&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      icons: [</span><br><span class="line">        &#123;// eslint-disable-next-line</span><br><span class="line">         // picUrl: require(&quot;../../assets/GitHub.svg&quot;),</span><br><span class="line">          picUrl: &quot;../../assets/GitHub.svg&quot;,</span><br><span class="line">          url: &quot;https://github.com/twodogwang&quot;,</span><br><span class="line">          alt: &quot;GayHub&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;// eslint-disable-next-line</span><br><span class="line">         // picUrl: require(&quot;../../assets/weibo.svg&quot;),</span><br><span class="line">          picUrl: &quot;../../assets/weibo.svg&quot;,</span><br><span class="line">          url: &quot;&quot;,</span><br><span class="line">          alt: &quot;Weibo&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>起初是想循环一个很简单的a标签内嵌一个img标签，img标签的src是通过循环的数组中获取，起初的写法如上，url是个字符串。但是这样在渲染完成之后，渲染在html结构中的img标签的src就是picUrl属性的值，而直接写在html结构中是一个base64格式的图片。写成注释中的require写法，应该是可以直接通过loader转换为base64格式了。有待研究。</p>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/23/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/23/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/23/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-22T13:41:10.000Z"><a href="/2018/01/22/post/">Mon, Jan 22 2018, 9:41:10 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/22/post/">关于.sync</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/Vue-props-sync-父子组件/">Vue,props,.sync,父子组件</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <blockquote>
<p><a href="https://cn.vuejs.org/v2/guide/components.html#%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%A1%A8%E5%8D%95%E8%BE%93%E5%85%A5%E7%BB%84%E4%BB%B6" target="_blank" rel="noopener">在一些情况下，我们可能会需要对一个 prop 进行“双向绑定”。事实上，这正是 Vue 1.x 中的 .sync 修饰符所提供的功能。当一个子组件改变了一个带 .sync 的 prop 的值时，这个变化也会同步到父组件中所绑定的值。这很方便，但也会导致问题，因为它破坏了单向数据流。由于子组件改变 prop 的代码和普通的状态改动代码毫无区别，当光看子组件的代码时，你完全不知道它何时悄悄地改变了父组件的状态。这在 debug 复杂结构的应用时会带来很高的维护成本。<br>上面所说的正是我们在 2.0 中移除 .sync 的理由。但是在 2.0 发布之后的实际应用中，我们发现 .sync 还是有其适用之处，比如在开发可复用的组件库时。我们需要做的只是让子组件改变父组件状态的代码更容易被区分。<br>从 2.3.0 起我们重新引入了 .sync 修饰符，但是这次它只是作为一个编译时的语法糖存在。它会被扩展为一个自动更新父组件属性的 v-on 监听器。</a></p>
</blockquote>
<p>今天在做一个需要传入组件中然后返回一个值的需求中，想通过传入props参数，在组件进行处理，返回一个值给父组件。当时想的不够全面，复杂化了问题。其实有两种方法。</p>
<ol>
<li>可以通过直接修改props属性传入的值达到目的。该方法有个好处，就是父组件中用的数组和在子组件中修改并展示的数组是同一个数组。也就是说，在子组件中对props属性进行修改，可以实时地体现在其他地方。其实本来项目中写的这种写法不应成立，现在个人理解之所以可以达到效果是因为JS中的堆栈数据的区别，也就是值类型和引用类型的区别。值类型（基本类型）的数据，一般包括(number,string,boolean,null,undefined)这些类型的值，它们的值是存在栈区（内存里的栈内存）的，在修改它们值的时候（简单的赋值操作），就是直接修改了它存在内存里的值。而引用类型在修改、赋值之类的操作时，由于它们的值存在栈区和堆区中，栈区中存放的是一个指针，它指向该变量存放在堆中的值。由于JS的特性，我们不能直接操作其在内存中的值，所以我们在赋值时其实是将它的指针赋给了其他变量。那么其他变量所对应的值不仅相同，而且是同一个值，也就是说我们修改其中一个值，另一个值也会被改变。所以在上例中时，在子组件中修改传入的值时，由于正好传入的是Array类型的值，引用变量，所以在子组件中修改它的值，对应到父组件中也变化了，本来应该单向绑定的props属性却变成了双向绑定（明天去公司修改一下验证我的猜想）。</li>
<li>今天在修改组件时，也曾试着不直接修改props属性传入的值，而是拿到传入的值后“复制”一份值（此时也不可以直接赋值，可以用<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].concat(props传入的值)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>来进行拷贝）。然后在组件中不管是添加修改删除都是操作这个复制品，传入的值只作为初始化展示用。在正删改查时emit父组件对应的方法并将修改后的复制品的值传入进行提交即可。不过好像有点麻烦。</p>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/22/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/22/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/22/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-20T15:01:31.000Z"><a href="/2018/01/20/post/">Sat, Jan 20 2018, 11:01:31 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/20/post/">Vue组件的问题（slot插槽和slot-scope传值）</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/Vue、slot/">Vue、slot</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <h3 id="关于Vue中的slot（插槽）"><a href="#关于Vue中的slot（插槽）" class="headerlink" title="关于Vue中的slot（插槽）"></a>关于Vue中的slot（插槽）</h3><hr>
<ol>
<li>之前不是很理解插槽的作用，因为理解中组件应该是抽象出来的一个概念。例如两个地方用着一样的列表组件，展示方式和样式一样，这样就可以抽象出一个组件，在用的时候只要在父模板中向子组件传递所需要的参数，例如一个数组，内容是所需要的标题，内容等所组成的一个个对象，这样传递给子组件，就可以渲染出所需要的效果。</li>
</ol>
<p>但是这个模式所构建的组件有个问题，就是内容定的很死。比如如果组件的结构是如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt; </span><br><span class="line">    &lt;transition name=&quot;t3&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;no_record&quot; v-show=&quot;!list.length&quot;&gt;没有符合条件的记录&lt;/div&gt;</span><br><span class="line">    &lt;/transition&gt;</span><br><span class="line">    &lt;yd-infinitescroll :callback=&quot;loadList&quot; ref=&quot;end&quot;&gt;</span><br><span class="line">        &lt;!--&lt;ul slot=&quot;list&quot;&gt;--&gt;</span><br><span class="line">            </span><br><span class="line">        &lt;!--	&lt;slot v-for=&quot;(item,index) in list&quot;--&gt;</span><br><span class="line">        &lt;!--	name=&quot;item&quot;--&gt;</span><br><span class="line">        &lt;!--	:item_data=&quot;item&quot;--&gt;</span><br><span class="line">        &lt;!--    :index_data=&quot;index&quot;&gt;--&gt;</span><br><span class="line">        &lt;!--	&lt;/slot&gt;--&gt;</span><br><span class="line">        &lt;!--&lt;/ul&gt;--&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 数据全部加载完毕显示 --&gt;</span><br><span class="line">        &lt;!--&lt;span slot=&quot;doneTip&quot;&gt;终结于第&#123;&#123;page&#125;&#125;页&lt;/span&gt;--&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 加载中提示，不指定，将显示默认加载中图标 --&gt;</span><br><span class="line">        &lt;!--&lt;img slot=&quot;loadingTip&quot; src=&quot;images/loading10.svg&quot;/&gt;--&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/yd-infinitescroll&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p>这样子的组件结构定死，如果有个只需要展示一个文字的列表或者图片的列表或者要在列表中添加链接等等情况，这样的组件就不能很灵活的满足要求。所以就有了slot的用武之地。如上代码中注释的部分，在用父组件时候，在子组件的template标签<child></child>中，添加内容<a>这是想渲染在页面的内容并且在子组件内</a>。在子组件中对应的需要slot插槽来提供给父组件中写的这个内容。此处也有一些name属性的区别。</p>
<ol>
<li><a href="https://cn.vuejs.org/v2/guide/components.html#%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%8F%92%E6%A7%BD" target="_blank" rel="noopener">关于slot-scope</a>这是一种特殊的插槽（slot），既然是插槽，个人理解就是子组件中的slot标签可以向父组件传递值。如下代码中，在不会渲染成HTML标签的template标签中添加slot属性指定子组件的slot插槽的name属性为item，并且添加了slot-scope属性指定了一个用来接收子组件中插槽传递值的一个变量名为props。这样，在指定了slot-scope属性的标签下，便可以使用这个子组件插槽传过来的值。代码中的<aa>标签是另一个组件，在其中也可以用插槽传过来的这个值。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;du_list_post url=&quot;/Knowledge/GetKnowLedgeMore&quot; :test=&quot;test_arr&quot; class=&quot;list_pic&quot; name=&quot;就医记录列表&quot; ref=&quot;list1&quot;&gt;</span><br><span class="line">        &lt;template slot=&quot;item&quot; slot-scope=&quot;props&quot;&gt;</span><br><span class="line">          &lt;li&gt;</span><br><span class="line">            &lt;aa href=&quot;know_detail.html&quot; :obj=&quot;&#123;InfoId:props.item_data.InfoId,TypeId:props.item_data.TypeId&#125;&quot;&gt;</span><br><span class="line">              &lt;div class=&quot;pic&quot; :style=&quot;&#123;backgroundImage: &apos;url(&apos; + props.item_data.pic + &apos;)&apos;&#125;&quot;&gt;&lt;/div&gt;</span><br><span class="line">              &lt;div class=&quot;cont&quot;&gt;</span><br><span class="line">                &lt;h2&gt;&#123;&#123; props.item_data.title &#125;&#125;&lt;/h2&gt;</span><br><span class="line">                &lt;h3&gt;&#123;&#123; props.item_data.date &#125;&#125;&lt;/h3&gt; </span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/aa&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;/du_list_post&gt;</span><br></pre></td></tr></table></figure>
</aa></li>
</ol>
<p>PS：昨天朋友来访，吃饭喝酒去了，没更新，罪过罪过。QAQ</p>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/20/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/20/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/20/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-18T13:57:17.000Z"><a href="/2018/01/18/post/">Thu, Jan 18 2018, 9:57:17 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/18/post/">Vue的一些大问题</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/Vue-非脚手架的Vue/">Vue,非脚手架的Vue</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <ol>
<li>关于非脚手架（vue-cli）开发。非脚手架开发时，不会像webpack最终打包成一个HTML文件一样，会有许多页面许多模块进行拼装，在每个HTML文件中，和一般HTML页面一样，有DOCTYPE声明，style，script引入标签。每个页面应生成自己专属的Vue实例，因此在声明实例data配置时，不需要声明一个返回函数，完全可以声明一个对象，因为每个实例都是独立的，所以不会有对象形式声明的data中出现值共享的情况。</li>
<li>同时，由于Vue实例独立的问题，Vuex不可用，一切都按照一般的页面进行布局和传递数据。如localstorage，sessionstorage，URLquery等方式。</li>
<li>在Vue的实例上，有set方法。set方法。 这个方法主要用于添加一些属性时，能够拥有响应式的特性。个人理解为，由于Vue实现响应式的方法是定义的getter和setter，在Vue实例化时定义的值都会被写上getter和setter的方法，<a href="https://cn.vuejs.org/v2/guide/reactivity.html#ad" target="_blank" rel="noopener">类似于订阅式的通知方式</a>。直接在data中声明的对象上添加新的属性时，值可以传递，但是不会触发双向绑定的事件，对应的dom不会更新。<blockquote>
<p>Vue.set( target, key, value )设置对象的属性。如果对象是响应式的，确保属性被创建后也是响应式的，同时触发视图更新。这个方法主要用于避开 Vue 不能检测属性被添加的限制。</p>
</blockquote>
</li>
<li>Vue中的mixins。目前理解为和extend类似的属性，只是mixins的优先级要高于被拓展的原实例。例如在mixins中，定义了mounted钩子函数的话，会比被混合的原实例中定义的mounted钩子函数要先触发。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var vm = new Vue(&#123;</span><br><span class="line">    mixins: [mixin_common],</span><br><span class="line">    el: &apos;#app&apos;,</span><br><span class="line">    mounted: function () &#123;</span><br><span class="line">      // this.loading(false);</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      searchH: function (txt) &#123;</span><br><span class="line">        window.location.href = &apos;knowSearch.html&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    data: &#123;</span><br><span class="line">      test_arr: [</span><br><span class="line">        &#123; id: 1, pic: &quot;images/a1.png&quot;, tit: &quot;血压，到底该量左手还是右手？出现这个问题要小心了&quot;, date: &quot;2017-12-12&quot; &#125;,</span><br><span class="line">        &#123; id: 2, pic: &quot;images/a1.png&quot;, tit: &quot;这是另一个句子&quot;, date: &quot;2017-12-12&quot; &#125;,</span><br><span class="line">        &#123; id: 3, pic: &quot;images/a2.png&quot;, tit: &quot;这是另一个句子&quot;, date: &quot;2017-12-12&quot; &#125;,</span><br><span class="line">        &#123; id: 1, pic: &quot;images/a3.png&quot;, tit: &quot;这是另一个句子&quot;, date: &quot;2017-12-12&quot; &#125;,</span><br><span class="line">        &#123; id: 1, pic: &quot;images/a2.png&quot;, tit: &quot;这是另一个句子&quot;, date: &quot;2017-12-12&quot; &#125;,</span><br><span class="line">        &#123; id: 1, pic: &quot;images/a1.png&quot;, tit: &quot;血压，到底该量左手还是右手？出现这个问题要小心了&quot;, date: &quot;2017-12-12&quot; &#125;,</span><br><span class="line">        &#123; id: 1, pic: &quot;images/a1.png&quot;, tit: &quot;血压，到底该量左手还是右手？出现这个问题要小心了&quot;, date: &quot;2017-12-12&quot; &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">var mixin_common = &#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    search_key: &quot;&quot;,</span><br><span class="line">    qs: &#123;&#125;   //专门用来接收页面传参</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted: function () &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  /*watch:&#123;</span><br><span class="line">    loading:function(curVal,oldVal)&#123;&#125;</span><br><span class="line">  &#125;,*/</span><br><span class="line">  computed: &#123;</span><br><span class="line">    header_token: function () &#123;</span><br><span class="line">      return &#123; token: &quot;M3Bu8CXsuQhCvBH8JTkkjpCc81qUz4DK44bL3vhDsCungmuLrHseo2SNeDVNFBJzBq/1SbeEU0VVrq/CPVurCyMt5+YlQ735w/W/auBpyQSE9kkn24eySK7T2ZdoYZgX6PXALReS5l51QwzVf0eQnYvDJJBKxG91Wpz9cvbg3Rw=&quot; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  methods: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    toast: function (str, flag) &#123;</span><br><span class="line">      flag = flag ? flag : &quot;&quot;;</span><br><span class="line">      this.$dialog.toast(&#123;</span><br><span class="line">        mes: str,</span><br><span class="line">        icon: flag,</span><br><span class="line">        timeout: 2000</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    loading: function (flag) &#123;</span><br><span class="line">      if (flag) &#123;</span><br><span class="line">        document.querySelector(&quot;#loading&quot;).style.display = &quot;block&quot;;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        if (document.querySelector(&quot;#loading&quot;)) document.querySelector(&quot;#loading&quot;).style.display = &quot;none&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/18/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/18/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/18/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-17T14:29:52.000Z"><a href="/2018/01/17/post/">Wed, Jan 17 2018, 10:29:52 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/17/post/">Vue中的小问题</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/Vue-Vue生命周期-钩子函数/">Vue,Vue生命周期,钩子函数</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <h1 id="Vue中的小问题"><a href="#Vue中的小问题" class="headerlink" title="Vue中的小问题"></a>Vue中的小问题</h1><hr>
<ol>
<li>watch和computed都是根据所依赖而改变值，其中，watch是监听所指定的变量的变化情况而调用，computed则是根据所依赖的变量进行变化。暂时理解是指定函数中的返回值。<strong>需要注意的是，不管是watch还是computed，所依赖的值必须为Vue实例上的属性，如下代码中，如果监听window.screen.availHeight的变化来改变bannerImgTop值，则会出现监测不到的情况。</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      bannerImgTop: window.screen.availHeight + &quot;px&quot;,</span><br><span class="line">      bannerImgHeight: window.screen.availHeight - 40 + &quot;px&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    bannerImgTop() &#123;</span><br><span class="line">      if (window.screen.availHeight)</span><br><span class="line">      console.log(`-------------------`)</span><br><span class="line">      return window.screen.availHeight+&apos;px&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line">      window.screen.availHeight:function()&#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    console.log(this.bannerImgTop);</span><br><span class="line">    window.onresize = () =&gt; &#123;</span><br><span class="line">      //   console.log(this.bannerImgTop);</span><br><span class="line">    //   this.bannerImgTop = window.screen.availHeight + &quot;px&quot;;</span><br><span class="line">      console.log(window.screen.availHeight);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>如果改成如下，在触发onresize事件时修改data中定义的test值，通过依赖test来返回值得bannerImgTop或者watch实例的test时则会发生变化。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      bannerImgTop: window.screen.availHeight + &quot;px&quot;,</span><br><span class="line">      bannerImgHeight: window.screen.availHeight - 40 + &quot;px&quot;,</span><br><span class="line">      test: 123</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    bannerImgTop() &#123;</span><br><span class="line">      if (window.screen.availHeight)</span><br><span class="line">      console.log(`-------------------`)</span><br><span class="line">      // return window.screen.availHeight+&apos;px&apos;</span><br><span class="line">      return this.test;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; ,</span><br><span class="line">  watch: &#123;</span><br><span class="line">      test:function()&#123;</span><br><span class="line">          console.log(&apos;++++++++++&apos;)</span><br><span class="line">          this.bannerImgHeight = 100+&apos;px&apos;;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    console.log(this.bannerImgTop);</span><br><span class="line">    window.onresize = () =&gt; &#123;</span><br><span class="line">      this.test = window.screen.availHeight;</span><br><span class="line">      console.log(window.screen.availHeight);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/17/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/17/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/17/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2018-01-16T12:39:20.000Z"><a href="/2018/01/16/post/">Tue, Jan 16 2018, 8:39:20 pm</a></time>

  
    <h1 class="title"><a href="/2018/01/16/post/">ThinkJs</a></h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/ThinkJs-koa-后端/">ThinkJs,koa,后端</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <h1 id="ThinkJS"><a href="#ThinkJS" class="headerlink" title="ThinkJS"></a>ThinkJS</h1><p><strong>ThinkJs基于koa2，基本框架搭好，其余只需在配置中配好即可。</strong></p>
<h6 id="本质上和express框架、koa框架差不多。MVC框架：用户通过对应uri接口可以访问router，通过为对应uri定义的controller对请求进行操作，返回Json数据或者直接渲染模板引擎，如ejs、nunjucks等。"><a href="#本质上和express框架、koa框架差不多。MVC框架：用户通过对应uri接口可以访问router，通过为对应uri定义的controller对请求进行操作，返回Json数据或者直接渲染模板引擎，如ejs、nunjucks等。" class="headerlink" title="本质上和express框架、koa框架差不多。MVC框架：用户通过对应uri接口可以访问router，通过为对应uri定义的controller对请求进行操作，返回Json数据或者直接渲染模板引擎，如ejs、nunjucks等。"></a>本质上和express框架、koa框架差不多。MVC框架：用户通过对应uri接口可以访问router，通过为对应uri定义的controller对请求进行操作，返回Json数据或者直接渲染模板引擎，如ejs、nunjucks等。</h6><p><strong>基本结构如下</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">|--- development.js   //开发环境下的入口文件</span><br><span class="line">|--- nginx.conf  //nginx 配置文件</span><br><span class="line">|--- package.json</span><br><span class="line">|--- pm2.json //pm2 配置文件</span><br><span class="line">|--- production.js //生产环境下的入口文件</span><br><span class="line">|--- README.md</span><br><span class="line">|--- src</span><br><span class="line">| |--- bootstrap  //启动自动执行目录 </span><br><span class="line">| | |--- master.js //Master 进程下自动执行</span><br><span class="line">| | |--- worker.js //Worker 进程下自动执行</span><br><span class="line">| |--- config  //配置文件目录</span><br><span class="line">| | |--- adapter.js  // adapter 配置文件 </span><br><span class="line">| | |--- config.js  // 默认配置文件 </span><br><span class="line">| | |--- config.production.js  //生产环境下的默认配置文件，和 config.js 合并 </span><br><span class="line">| | |--- extend.js  //extend 配置文件 </span><br><span class="line">| | |--- middleware.js //middleware 配置文件 </span><br><span class="line">| | |--- router.js //自定义路由配置文件</span><br><span class="line">| |--- controller  //控制器目录 </span><br><span class="line">| | |--- base.js</span><br><span class="line">| | |--- index.js</span><br><span class="line">| |--- service  //服务目录 </span><br><span class="line">| | |--- **.js //用户自己定义的服务</span><br><span class="line">| |--- logic //logic 目录</span><br><span class="line">| | |--- index.js</span><br><span class="line">| |--- model //模型目录</span><br><span class="line">| | |--- index.js</span><br><span class="line">|--- view  //模板目录</span><br><span class="line">| |--- index_index.html</span><br><span class="line">|--- www</span><br><span class="line">| |--- static  //静态资源目录</span><br><span class="line">| | |--- css</span><br><span class="line">| | |--- img</span><br><span class="line">| | |--- js</span><br></pre></td></tr></table></figure></p>
<h6 id="与一般简单框架需要自己搭建model–router–controller–view不同，ThinkJs中只需在对应的文件夹中存放相应的文件即可。"><a href="#与一般简单框架需要自己搭建model–router–controller–view不同，ThinkJs中只需在对应的文件夹中存放相应的文件即可。" class="headerlink" title="与一般简单框架需要自己搭建model–router–controller–view不同，ThinkJs中只需在对应的文件夹中存放相应的文件即可。"></a>与一般简单框架需要自己搭建model–router–controller–view不同，ThinkJs中只需在对应的文件夹中存放相应的文件即可。</h6><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">const Base = require(&apos;./base&apos;);</span><br><span class="line"></span><br><span class="line">module.exports = class extends Base &#123;</span><br><span class="line">    testAction() &#123;</span><br><span class="line">        this.body = &#123;</span><br><span class="line">            allowMethod: &apos;post&apos;,</span><br><span class="line">            note: &quot;when you see this note,you are using &apos;post&apos; method&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    testGetAction() &#123;</span><br><span class="line">        this.body = `接收到的get参数为$&#123;this.get().param&#125;`</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    async testPostAction() &#123;</span><br><span class="line">        const actor = this.ctx.model(&apos;actor&apos;);</span><br><span class="line">        console.log(this.ctx.request.body)</span><br><span class="line">        this.body = await actor.find(&#123;</span><br><span class="line">            where: &#123;</span><br><span class="line">                actor_id: 3</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    indexAction() &#123;</span><br><span class="line">        this.body = &apos;这是controller/test.js中的indexAction方法&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>e.g.如果我们要访问  <a href="http://localhost:25101/login" target="_blank" rel="noopener">http://localhost:25101/login</a>  接口，则需要在controller文件夹中（直接在controller层写）定义一个Js文件login.js，文件中只需用class继承同级的base.js文件中的Base类（Base类已经继承了think.controller），在login.js中定义的方法indexAction()。如果需要访问  <a href="http://localhost:25101/login/test" target="_blank" rel="noopener">http://localhost:25101/login/test</a>  接口，则需要在该文件中再定义一个testAction()方法。即xxxAction作为方法名即可用对应的xxx作为接口访问，省去了单独定义router中url的环节。</li>
<li><p>此外，如果需要在controller中查询数据库，可以通过ThinkJs自带的ORM定义schema，生成model，在生成的model中有CRUD的api。数据库配置需要在config/adapter.js中定义。在文件中定义了数据库名（database）后，如果需要访问数据库中表的话，在controller同级的model文件夹中以表名新建Js文件，文件中只需继承think.model类即可（针对MySQL）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * model adapter config</span><br><span class="line"> * @type &#123;Object&#125;</span><br><span class="line"> */</span><br><span class="line">exports.model = &#123;</span><br><span class="line">  type: &apos;mysql&apos;,</span><br><span class="line">  common: &#123;</span><br><span class="line">    logConnect: isDev,</span><br><span class="line">    logSql: isDev,</span><br><span class="line">    logger: msg =&gt; think.logger.info(msg)</span><br><span class="line">  &#125;,</span><br><span class="line">  mysql: &#123;</span><br><span class="line">    handle: mysql,</span><br><span class="line">    database: &apos;sakila&apos;,</span><br><span class="line">    prefix: &apos;&apos;,</span><br><span class="line">    encoding: &apos;utf8&apos;,</span><br><span class="line">    host: &apos;localhost&apos;,</span><br><span class="line">    port: &apos;3306&apos;,</span><br><span class="line">    user: &apos;root&apos;,</span><br><span class="line">    password: &apos;2510129&apos;,</span><br><span class="line">    dateStrings: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在controller中直接定义的方法，通过对应的url即可访问，无论访问方法是get还是post。如果需要进行筛选，可在controller同级的logic文件夹中定义一个和controller中相同名称的js。在文件中定义一个与你需要进行预拦截的方法名称一样的方法。相当于一个后端request拦截器，可以对请求进行筛选访问或者进行改造之类。</p>
</li>
</ol>

      
    </div>
    <footer>
      
        <div class="alignleft">
            <a href="/2018/01/16/post/#more" class="more-link"><i class="fa fa-chevron-right"></i>Read More</a>
        </div>
        
        
          <div class="alignright"> 
            <a href="http://yoursite.com/2018/01/16/post/#comment" class="comment-link">
              <i class="fa fa-comments"></i><span class="ds-thread-count" data-thread-key="/2018/01/16/post/">&nbsp;
              </span>
            </a>
          </div>
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">Nächste Seite<i class="fa fa-long-arrow-right"></i></a>
  
  <div class="clearfix"></div>
</nav>

<script src="/js/jquery.anystretch.min.js"></script>
<script src="/js/cover.js"></script>

    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div>
  
  &copy; 2018 cqyxy
  
</div>
Powered by <a href="http://zespia.tw/hexo/" title="Hexo" target="_blank" rel="noopener">Hexo</a> and <a href="http://pages.github.com/" title="GitHub Pages" target="_blank" rel="noopener">GitHub Pages</a>

<div class="clearfix"></div></footer>
  
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>




    <script type="text/javascript">
        (function(){

            $(window).scroll(function(){

                var scrollTop = $(window).scrollTop();
                if ( scrollTop >200 ){
                    $("#main-nav").removeClass('normal_mode').addClass('top_mode');
                } else{
                    $("#main-nav").removeClass('top_mode').addClass('normal_mode');
                }

            });

        })();
    </script>



  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript">
  (function($){
    $('.fancybox').fancybox({
      'titlePosition': 'inside'
    });
  })(jQuery);
  </script>



    
    <script type="text/javascript">
      var duoshuoQuery = {short_name:"twodogwang"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = 'http://static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0] 
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>



<script type="text/javascript">
  
  $(function(){

    $('.title').hover(
      function() {      
        $(this).stop().animate(
          {'marginLeft': '10px'}, 200
        );   
      }, 
      function() {       
        $(this).stop().animate({'marginLeft': '0px'}, 200);      
      
    });   

  });

</script>


</body>
</html>